(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{459:function(s,e,a){"use strict";a.r(e);var t=a(1),n=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"配置-docker0-网桥"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#配置-docker0-网桥"}},[s._v("#")]),s._v(" 配置 docker0 网桥")]),s._v(" "),e("p",[s._v("Docker 服务默认会创建一个 "),e("code",[s._v("docker0")]),s._v(" 网桥（其上有一个 "),e("code",[s._v("docker0")]),s._v(" 内部接口），它在内核层连通了其他的物理或虚拟网卡，这就将所有容器和本地主机都放到同一个物理网络。")]),s._v(" "),e("p",[s._v("Docker 默认指定了 "),e("code",[s._v("docker0")]),s._v(" 接口 的 IP 地址和子网掩码，让主机和容器之间可以通过网桥相互通信，它还给出了 MTU（接口允许接收的最大传输单元），通常是 1500 Bytes，或宿主主机网络路由上支持的默认值。这些值都可以在服务启动的时候进行配置。")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("--bip=CIDR")]),s._v(" IP 地址加掩码格式，例如 192.168.1.5/24")]),s._v(" "),e("li",[e("code",[s._v("--mtu=BYTES")]),s._v(" 覆盖默认的 Docker mtu 配置")])]),s._v(" "),e("p",[s._v("也可以在配置文件中配置 DOCKER_OPTS，然后重启服务。")]),s._v(" "),e("p",[s._v("由于目前 Docker 网桥是 Linux 网桥，用户可以使用 "),e("code",[s._v("brctl show")]),s._v(" 来查看网桥和端口连接信息。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" brctl show\nbridge name     bridge "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v("               STP enabled     interfaces\ndocker0         "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(".3a1d7362b4ee       no              veth65f9\n                                             vethdda6\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("p",[s._v("*注："),e("code",[s._v("brctl")]),s._v(" 命令在 Debian、Ubuntu 中可以使用 "),e("code",[s._v("sudo apt-get install bridge-utils")]),s._v(" 来安装。")]),s._v(" "),e("p",[s._v("每次创建一个新容器的时候，Docker 从可用的地址段中选择一个空闲的 IP 地址分配给容器的 eth0 端口。使用本地主机上 "),e("code",[s._v("docker0")]),s._v(" 接口的 IP 作为所有容器的默认网关。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" base /bin/bash\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" addr show eth0\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(": eth0: "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("BROADCAST,UP,LOWER_UP"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" mtu "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1500")]),s._v(" qdisc pfifo_fast state UP group default qlen "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n    link/ether "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("32")]),s._v(":6f:e0:35:57:91 brd ff:ff:ff:ff:ff:ff\n    inet "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3/16 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::306f:e0ff:fe35:5791/64 scope "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("\n       valid_lft forever preferred_lft forever\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" route\ndefault via "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".42.1 dev eth0\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.0/16 dev eth0  proto kernel  scope "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("link")]),s._v("  src "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.17")]),s._v(".0.3\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);